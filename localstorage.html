<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LocalStorage Manager - X DKV 3</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸ’¾</text></svg>">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            color: #e0e0e0;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .logo i {
            font-size: 40px;
            color: #4cc9f0;
        }

        h1 {
            font-size: 32px;
            color: #fff;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #8a8a8a;
            font-size: 18px;
            margin-bottom: 20px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 25px;
            border-left: 4px solid;
            transition: transform 0.3s, background 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.08);
        }

        .stat-card.blue { border-color: #4cc9f0; }
        .stat-card.green { border-color: #2ed573; }
        .stat-card.orange { border-color: #ffa502; }
        .stat-card.purple { border-color: #9b59b6; }

        .stat-icon {
            font-size: 30px;
            margin-bottom: 15px;
        }

        .stat-value {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 5px;
            color: #fff;
        }

        .stat-label {
            font-size: 14px;
            color: #8a8a8a;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .dashboard {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        .sidebar {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 25px;
            height: fit-content;
        }

        .sidebar h3 {
            margin-bottom: 20px;
            color: #fff;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .action-btn {
            display: flex;
            align-items: center;
            gap: 12px;
            width: 100%;
            padding: 15px;
            background: rgba(255, 255, 255, 0.08);
            border: none;
            border-radius: 10px;
            color: #e0e0e0;
            font-size: 16px;
            cursor: pointer;
            margin-bottom: 10px;
            transition: all 0.3s;
            text-align: left;
        }

        .action-btn:hover {
            background: rgba(255, 255, 255, 0.12);
            transform: translateX(5px);
        }

        .action-btn.active {
            background: rgba(76, 201, 240, 0.2);
            color: #4cc9f0;
        }

        .action-btn.danger:hover {
            background: rgba(255, 71, 87, 0.2);
            color: #ff4757;
        }

        .content-area {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 30px;
            min-height: 500px;
        }

        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-title {
            margin-bottom: 25px;
            color: #fff;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 24px;
        }

        .storage-items {
            max-height: 500px;
            overflow-y: auto;
        }

        .storage-item {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: background 0.3s;
        }

        .storage-item:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            cursor: pointer;
        }

        .item-key {
            font-weight: bold;
            color: #4cc9f0;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .item-size {
            color: #8a8a8a;
            font-size: 14px;
            background: rgba(255, 255, 255, 0.1);
            padding: 3px 10px;
            border-radius: 10px;
        }

        .item-value {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 15px;
            margin-top: 10px;
            font-family: 'Consolas', monospace;
            font-size: 14px;
            overflow-x: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
            max-height: 200px;
            overflow-y: auto;
        }

        .item-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .storage-item:hover .item-actions {
            opacity: 1;
        }

        .btn-small {
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: all 0.3s;
        }

        .btn-edit { background: #3498db; color: white; }
        .btn-delete { background: #e74c3c; color: white; }
        .btn-copy { background: #2ecc71; color: white; }

        .btn-small:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        /* Backup Section */
        .backup-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .backup-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            transition: transform 0.3s;
        }

        .backup-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.08);
        }

        .backup-icon {
            font-size: 40px;
            margin-bottom: 15px;
            color: #4cc9f0;
        }

        .backup-btn {
            background: #4cc9f0;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            margin-top: 15px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }

        .backup-btn:hover {
            background: #3498db;
            transform: translateY(-3px);
        }

        /* Import Section */
        .import-area {
            border: 3px dashed rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 50px;
            text-align: center;
            margin-top: 20px;
            transition: all 0.3s;
            cursor: pointer;
        }

        .import-area:hover {
            border-color: #4cc9f0;
            background: rgba(76, 201, 240, 0.1);
        }

        .import-icon {
            font-size: 50px;
            color: #4cc9f0;
            margin-bottom: 15px;
        }

        .file-input {
            display: none;
        }

        /* Settings Section */
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .setting-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 20px;
        }

        .setting-label {
            font-weight: 600;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 30px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .toggle-slider {
            background-color: #4cc9f0;
        }

        input:checked + .toggle-slider:before {
            transform: translateX(30px);
        }

        .slider {
            width: 100%;
            margin-top: 10px;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            background: #1a1a2e;
            border-radius: 15px;
            padding: 30px;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-close {
            background: none;
            border: none;
            color: #8a8a8a;
            font-size: 24px;
            cursor: pointer;
            transition: color 0.3s;
        }

        .modal-close:hover {
            color: #fff;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .form-control {
            width: 100%;
            padding: 12px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: #fff;
            font-size: 16px;
        }

        .form-control:focus {
            outline: none;
            border-color: #4cc9f0;
        }

        .btn-primary {
            background: #4cc9f0;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            width: 100%;
            transition: background 0.3s;
        }

        .btn-primary:hover {
            background: #3498db;
        }

        /* Notification */
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #2ed573;
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 1001;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s ease;
        }

        .notification.show {
            transform: translateY(0);
            opacity: 1;
        }

        .notification.error {
            background: #e74c3c;
        }

        .notification.warning {
            background: #f39c12;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 50px;
            color: #8a8a8a;
        }

        .empty-state i {
            font-size: 60px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        /* Breadcrumb */
        .breadcrumb {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 25px;
            font-size: 14px;
        }

        .breadcrumb a {
            color: #4cc9f0;
            text-decoration: none;
        }

        .breadcrumb span {
            color: #8a8a8a;
        }

        /* Table View */
        .table-container {
            overflow-x: auto;
            margin-top: 20px;
        }

        .storage-table {
            width: 100%;
            border-collapse: collapse;
        }

        .storage-table th {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: #4cc9f0;
        }

        .storage-table td {
            padding: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .storage-table tr:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        /* Chart Container */
        .chart-container {
            height: 300px;
            margin-top: 20px;
            position: relative;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                order: 2;
            }
            
            .content-area {
                order: 1;
            }
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .backup-options, .settings-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <i class="fas fa-database"></i>
                <div>
                    <h1>LocalStorage Manager</h1>
                    <p class="subtitle">X DKV 3 - Kelas Desain Komunikasi Visual</p>
                </div>
            </div>
            <div class="breadcrumb">
                <a href="index.html"><i class="fas fa-home"></i> Beranda</a>
                <span>â€º</span>
                <span>LocalStorage Manager</span>
            </div>
        </header>

        <!-- Stats Grid -->
        <div class="stats-grid">
            <div class="stat-card blue">
                <div class="stat-icon">
                    <i class="fas fa-key"></i>
                </div>
                <div class="stat-value" id="totalKeys">0</div>
                <div class="stat-label">Total Keys</div>
            </div>
            
            <div class="stat-card green">
                <div class="stat-icon">
                    <i class="fas fa-hdd"></i>
                </div>
                <div class="stat-value" id="totalSize">0 KB</div>
                <div class="stat-label">Total Ukuran</div>
            </div>
            
            <div class="stat-card orange">
                <div class="stat-icon">
                    <i class="fas fa-chart-pie"></i>
                </div>
                <div class="stat-value" id="usedPercentage">0%</div>
                <div class="stat-label">Kapasitas Terpakai</div>
            </div>
            
            <div class="stat-card purple">
                <div class="stat-icon">
                    <i class="fas fa-clock"></i>
                </div>
                <div class="stat-value" id="lastUpdated">-</div>
                <div class="stat-label">Terakhir Diperbarui</div>
            </div>
        </div>

        <!-- Dashboard -->
        <div class="dashboard">
            <!-- Sidebar Actions -->
            <div class="sidebar">
                <h3><i class="fas fa-cogs"></i> Aksi</h3>
                <button class="action-btn active" data-section="view">
                    <i class="fas fa-eye"></i> Lihat Data
                </button>
                <button class="action-btn" data-section="backup">
                    <i class="fas fa-download"></i> Backup Data
                </button>
                <button class="action-btn" data-section="import">
                    <i class="fas fa-upload"></i> Import Data
                </button>
                <button class="action-btn" data-section="settings">
                    <i class="fas fa-sliders-h"></i> Pengaturan
                </button>
                <button class="action-btn danger" data-section="clear">
                    <i class="fas fa-trash"></i> Bersihkan Data
                </button>
                <button class="action-btn" id="refreshBtn">
                    <i class="fas fa-sync-alt"></i> Refresh Data
                </button>
            </div>

            <!-- Content Area -->
            <div class="content-area">
                <!-- View Data Section -->
                <div class="content-section active" id="view">
                    <h3 class="section-title">
                        <i class="fas fa-database"></i> Data LocalStorage
                        <span style="font-size: 14px; margin-left: auto;">
                        <button class="btn-small btn-copy" onclick="copyAllData()">
                            <i class="fas fa-copy"></i> Copy Semua
                        </button>
                        </span>
                    </h3>
                    
                    <div class="table-container">
                        <table class="storage-table">
                            <thead>
                                <tr>
                                    <th width="40%">Key</th>
                                    <th width="20%">Ukuran</th>
                                    <th width="20%">Tipe</th>
                                    <th width="20%">Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="storageTableBody">
                                <!-- Data akan diisi oleh JavaScript -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div id="noDataView" class="empty-state" style="display: none;">
                        <i class="fas fa-database"></i>
                        <h3>Tidak ada data di LocalStorage</h3>
                        <p>Mulai dengan menyimpan data atau import data dari file.</p>
                    </div>
                </div>

                <!-- Backup Section -->
                <div class="content-section" id="backup">
                    <h3 class="section-title">
                        <i class="fas fa-download"></i> Backup Data
                    </h3>
                    <p style="margin-bottom: 20px; color: #8a8a8a;">
                        Backup semua data LocalStorage ke file JSON. File ini dapat digunakan untuk restore data di kemudian hari.
                    </p>
                    
                    <div class="backup-options">
                        <div class="backup-card">
                            <div class="backup-icon">
                                <i class="fas fa-file-code"></i>
                            </div>
                            <h4>Backup JSON</h4>
                            <p>Simpan semua data dalam format JSON yang dapat dibaca manusia.</p>
                            <button class="backup-btn" onclick="backupData('json')">
                                <i class="fas fa-download"></i> Download JSON
                            </button>
                        </div>
                        
                        <div class="backup-card">
                            <div class="backup-icon">
                                <i class="fas fa-file-archive"></i>
                            </div>
                            <h4>Backup Terkompresi</h4>
                            <p>Simpan data dalam format terkompresi untuk ukuran file lebih kecil.</p>
                            <button class="backup-btn" onclick="backupData('compressed')">
                                <i class="fas fa-file-archive"></i> Download ZIP
                            </button>
                        </div>
                        
                        <div class="backup-card">
                            <div class="backup-icon">
                                <i class="fas fa-clipboard"></i>
                            </div>
                            <h4>Salin ke Clipboard</h4>
                            <p>Salin semua data ke clipboard untuk ditempel di tempat lain.</p>
                            <button class="backup-btn" onclick="copyToClipboard()">
                                <i class="fas fa-copy"></i> Copy Data
                            </button>
                        </div>
                    </div>
                    
                    <div style="margin-top: 30px; background: rgba(255, 255, 255, 0.05); padding: 20px; border-radius: 10px;">
                        <h4><i class="fas fa-info-circle"></i> Informasi Backup</h4>
                        <ul style="margin-top: 10px; padding-left: 20px; color: #8a8a8a;">
                            <li>Backup termasuk semua data dari semua aplikasi X DKV 3</li>
                            <li>File backup dapat di-restore kapan saja</li>
                            <li>Simpan file backup di tempat yang aman</li>
                            <li>Jangan bagikan file backup ke orang lain</li>
                        </ul>
                    </div>
                </div>

                <!-- Import Section -->
                <div class="content-section" id="import">
                    <h3 class="section-title">
                        <i class="fas fa-upload"></i> Import Data
                    </h3>
                    
                    <div class="import-area" id="importDropZone">
                        <div class="import-icon">
                            <i class="fas fa-cloud-upload-alt"></i>
                        </div>
                        <h4>Drag & Drop file JSON di sini</h4>
                        <p>atau klik untuk memilih file</p>
                        <p style="font-size: 12px; margin-top: 10px; color: #8a8a8a;">
                            Hanya file JSON yang didukung
                        </p>
                        <input type="file" id="importFile" class="file-input" accept=".json">
                    </div>
                    
                    <div style="margin-top: 30px; background: rgba(255, 255, 255, 0.05); padding: 20px; border-radius: 10px;">
                        <h4><i class="fas fa-exclamation-triangle"></i> Peringatan</h4>
                        <p style="margin-top: 10px; color: #ffa502;">
                            <strong>Import data akan mengganti data yang ada!</strong> Pastikan Anda sudah backup data saat ini sebelum mengimport data baru.
                        </p>
                    </div>
                </div>

                <!-- Settings Section -->
                <div class="content-section" id="settings">
                    <h3 class="section-title">
                        <i class="fas fa-sliders-h"></i> Pengaturan
                    </h3>
                    
                    <div class="settings-grid">
                        <div class="setting-item">
                            <div class="setting-label">
                                <i class="fas fa-bell"></i> Auto Backup
                            </div>
                            <p style="color: #8a8a8a; margin-bottom: 15px;">
                                Secara otomatis backup data saat ada perubahan
                            </p>
                            <label class="toggle-switch">
                                <input type="checkbox" id="autoBackup">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        
                        <div class="setting-item">
                            <div class="setting-label">
                                <i class="fas fa-trash-alt"></i> Auto Cleanup
                            </div>
                            <p style="color: #8a8a8a; margin-bottom: 15px;">
                                Otomatis hapus data yang sudah tidak digunakan
                            </p>
                            <label class="toggle-switch">
                                <input type="checkbox" id="autoCleanup">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        
                        <div class="setting-item">
                            <div class="setting-label">
                                <i class="fas fa-eye"></i> Tampilkan Value
                            </div>
                            <p style="color: #8a8a8a; margin-bottom: 15px;">
                                Tampilkan nilai lengkap data di tabel
                            </p>
                            <label class="toggle-switch">
                                <input type="checkbox" id="showValues" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        
                        <div class="setting-item">
                            <div class="setting-label">
                                <i class="fas fa-palette"></i> Tema
                            </div>
                            <p style="color: #8a8a8a; margin-bottom: 15px;">
                                Pilih tema tampilan
                            </p>
                            <select class="form-control" id="themeSelect">
                                <option value="dark">Dark Mode</option>
                                <option value="light">Light Mode</option>
                                <option value="auto">Auto (Sistem)</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Clear Section -->
                <div class="content-section" id="clear">
                    <h3 class="section-title">
                        <i class="fas fa-trash"></i> Bersihkan Data
                    </h3>
                    
                    <div style="background: rgba(231, 76, 60, 0.1); padding: 25px; border-radius: 12px; border-left: 4px solid #e74c3c;">
                        <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                            <i class="fas fa-exclamation-triangle" style="font-size: 30px; color: #e74c3c;"></i>
                            <div>
                                <h4 style="color: #e74c3c;">PERINGATAN!</h4>
                                <p style="color: #ffb8b2;">
                                    Tindakan ini akan menghapus data secara permanen. Pastikan Anda sudah backup data penting.
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 30px;">
                        <h4><i class="fas fa-filter"></i> Pilih Data yang Akan Dihapus</h4>
                        
                        <div style="margin-top: 20px; background: rgba(255, 255, 255, 0.05); padding: 20px; border-radius: 10px;">
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px;">
                                <input type="checkbox" id="selectAll">
                                <label for="selectAll">Pilih Semua</label>
                            </div>
                            
                            <div id="clearList" style="max-height: 200px; overflow-y: auto;">
                                <!-- Daftar data untuk dihapus -->
                            </div>
                        </div>
                        
                        <div style="margin-top: 30px; text-align: center;">
                            <button class="btn-primary" onclick="clearSelectedData()" style="background: #e74c3c;">
                                <i class="fas fa-trash"></i> HAPUS DATA TERPILIH
                            </button>
                            <button class="btn-primary" onclick="clearAllData()" style="background: #c0392b; margin-top: 10px;">
                                <i class="fas fa-skull-crossbones"></i> HAPUS SEMUA DATA
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Backup History -->
        <div style="background: rgba(255, 255, 255, 0.05); border-radius: 15px; padding: 25px; margin-top: 40px;">
            <h3 style="margin-bottom: 20px; color: #fff; display: flex; align-items: center; gap: 10px;">
                <i class="fas fa-history"></i> Riwayat Backup
            </h3>
            
            <div id="backupHistory" style="color: #8a8a8a;">
                <p>Tidak ada riwayat backup</p>
            </div>
        </div>
    </div>

    <!-- Modal for Edit -->
    <div class="modal" id="editModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-edit"></i> Edit Data</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Key:</label>
                    <input type="text" id="editKey" class="form-control" readonly>
                </div>
                <div class="form-group">
                    <label>Value:</label>
                    <textarea id="editValue" class="form-control" rows="10"></textarea>
                </div>
                <button class="btn-primary" onclick="saveEdit()">
                    <i class="fas fa-save"></i> Simpan Perubahan
                </button>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification">
        <i class="fas fa-check-circle"></i>
        <span id="notificationText"></span>
    </div>

    <script>
        // Global variables
        let currentEditingKey = null;
        let localStorageData = {};
        let settings = {
            autoBackup: false,
            autoCleanup: false,
            showValues: true,
            theme: 'dark'
        };

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            loadSettings();
            loadData();
            setupEventListeners();
            updateStats();
            
            // Check localStorage capacity
            checkStorageCapacity();
            
            // Auto update every 30 seconds
            setInterval(updateStats, 30000);
        });

        // Load settings from localStorage
        function loadSettings() {
            const savedSettings = localStorage.getItem('ls_manager_settings');
            if (savedSettings) {
                settings = JSON.parse(savedSettings);
                
                // Apply settings
                document.getElementById('autoBackup').checked = settings.autoBackup;
                document.getElementById('autoCleanup').checked = settings.autoCleanup;
                document.getElementById('showValues').checked = settings.showValues;
                document.getElementById('themeSelect').value = settings.theme;
                
                // Apply theme
                applyTheme(settings.theme);
            }
        }

        // Save settings to localStorage
        function saveSettings() {
            settings.autoBackup = document.getElementById('autoBackup').checked;
            settings.autoCleanup = document.getElementById('autoCleanup').checked;
            settings.showValues = document.getElementById('showValues').checked;
            settings.theme = document.getElementById('themeSelect').value;
            
            localStorage.setItem('ls_manager_settings', JSON.stringify(settings));
            applyTheme(settings.theme);
            showNotification('Pengaturan disimpan!', 'success');
        }

        // Apply theme
        function applyTheme(theme) {
            if (theme === 'light') {
                document.body.style.background = 'linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)';
                document.body.style.color = '#333';
            } else if (theme === 'dark') {
                document.body.style.background = 'linear-gradient(135deg, #1a1a2e 0%, #16213e 100%)';
                document.body.style.color = '#e0e0e0';
            } else {
                // Auto mode based on system preference
                if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    document.body.style.background = 'linear-gradient(135deg, #1a1a2e 0%, #16213e 100%)';
                    document.body.style.color = '#e0e0e0';
                } else {
                    document.body.style.background = 'linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)';
                    document.body.style.color = '#333';
                }
            }
        }

        // Load all localStorage data
        function loadData() {
            localStorageData = {};
            const tableBody = document.getElementById('storageTableBody');
            tableBody.innerHTML = '';
            
            if (localStorage.length === 0) {
                document.getElementById('noDataView').style.display = 'block';
                return;
            }
            
            document.getElementById('noDataView').style.display = 'none';
            
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                const value = localStorage.getItem(key);
                localStorageData[key] = value;
                
                // Create table row
                const row = document.createElement('tr');
                
                // Key cell
                const keyCell = document.createElement('td');
                keyCell.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-key" style="color: #4cc9f0;"></i>
                        <div>
                            <strong>${key}</strong>
                            <div style="font-size: 12px; color: #8a8a8a;">
                                ${getKeyType(key)}
                            </div>
                        </div>
                    </div>
                `;
                
                // Size cell
                const sizeCell = document.createElement('td');
                sizeCell.textContent = formatBytes(value.length);
                
                // Type cell
                const typeCell = document.createElement('td');
                typeCell.textContent = getValueType(value);
                
                // Actions cell
                const actionsCell = document.createElement('td');
                actionsCell.innerHTML = `
                    <div style="display: flex; gap: 5px;">
                        <button class="btn-small btn-edit" onclick="editData('${key}')">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                        <button class="btn-small btn-copy" onclick="copyData('${key}')">
                            <i class="fas fa-copy"></i> Copy
                        </button>
                        <button class="btn-small btn-delete" onclick="deleteData('${key}')">
                            <i class="fas fa-trash"></i> Hapus
                        </button>
                    </div>
                `;
                
                row.appendChild(keyCell);
                row.appendChild(sizeCell);
                row.appendChild(typeCell);
                row.appendChild(actionsCell);
                tableBody.appendChild(row);
            }
        }

        // Get key type based on prefix
        function getKeyType(key) {
            if (key.startsWith('xdkv3_')) return 'X DKV 3 App';
            if (key.startsWith('ls_manager_')) return 'LS Manager';
            if (key.includes('session')) return 'Session';
            if (key.includes('token')) return 'Token';
            if (key.includes('user')) return 'User Data';
            if (key.includes('settings')) return 'Settings';
            return 'Custom Data';
        }

        // Get value type
        function getValueType(value) {
            try {
                JSON.parse(value);
                return 'JSON Object';
            } catch {
                if (value === 'true' || value === 'false') return 'Boolean';
                if (!isNaN(value) && value !== '') return 'Number';
                if (value.startsWith('data:')) return 'Data URL';
                return 'String';
            }
        }

        // Format bytes to human readable
        function formatBytes(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // Update statistics
        function updateStats() {
            const totalKeys = localStorage.length;
            document.getElementById('totalKeys').textContent = totalKeys;
            
            // Calculate total size
            let totalSize = 0;
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                const value = localStorage.getItem(key);
                totalSize += key.length + value.length;
            }
            
            document.getElementById('totalSize').textContent = formatBytes(totalSize);
            
            // Calculate percentage (assuming 5MB limit)
            const maxSize = 5 * 1024 * 1024; // 5MB
            const usedPercentage = ((totalSize / maxSize) * 100).toFixed(1);
            document.getElementById('usedPercentage').textContent = usedPercentage + '%';
            
            // Update last updated time
            document.getElementById('lastUpdated').textContent = new Date().toLocaleTimeString();
        }

        // Check storage capacity
        function checkStorageCapacity() {
            let totalSize = 0;
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                const value = localStorage.getItem(key);
                totalSize += key.length + value.length;
            }
            
            const maxSize = 5 * 1024 * 1024; // 5MB
            const usedPercentage = (totalSize / maxSize) * 100;
            
            if (usedPercentage > 90) {
                showNotification('âš ï¸ LocalStorage hampir penuh!', 'warning');
            } else if (usedPercentage > 80) {
                showNotification('ðŸ’¾ LocalStorage 80% terisi, pertimbangkan untuk backup dan cleanup.', 'warning');
            }
        }

        // Setup event listeners
        function setupEventListeners() {
            // Navigation buttons
            document.querySelectorAll('.action-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    // Remove active class from all buttons
                    document.querySelectorAll('.action-btn').forEach(b => b.classList.remove('active'));
                    // Add active class to clicked button
                    this.classList.add('active');
                    
                    // Hide all sections
                    document.querySelectorAll('.content-section').forEach(section => {
                        section.classList.remove('active');
                    });
                    
                    // Show selected section
                    const sectionId = this.getAttribute('data-section');
                    document.getElementById(sectionId).classList.add('active');
                });
            });

            // Refresh button
            document.getElementById('refreshBtn').addEventListener('click', function() {
                loadData();
                updateStats();
                showNotification('Data diperbarui!', 'success');
                
                // Add spin animation
                this.querySelector('i').classList.add('fa-spin');
                setTimeout(() => {
                    this.querySelector('i').classList.remove('fa-spin');
                }, 500);
            });

            // Import file handling
            const importFile = document.getElementById('importFile');
            const importDropZone = document.getElementById('importDropZone');
            
            importDropZone.addEventListener('click', () => {
                importFile.click();
            });
            
            importFile.addEventListener('change', handleFileImport);
            
            // Drag and drop for import
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                importDropZone.addEventListener(eventName, preventDefaults, false);
            });
            
            ['dragenter', 'dragover'].forEach(eventName => {
                importDropZone.addEventListener(eventName, highlight, false);
            });
            
            ['dragleave', 'drop'].forEach(eventName => {
                importDropZone.addEventListener(eventName, unhighlight, false);
            });
            
            importDropZone.addEventListener('drop', handleDrop, false);
            
            // Settings change listeners
            document.getElementById('autoBackup').addEventListener('change', saveSettings);
            document.getElementById('autoCleanup').addEventListener('change', saveSettings);
            document.getElementById('showValues').addEventListener('change', saveSettings);
            document.getElementById('themeSelect').addEventListener('change', saveSettings);
        }

        // Prevent default behavior for drag and drop
        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        function highlight(e) {
            e.target.classList.add('highlight');
        }

        function unhighlight(e) {
            e.target.classList.remove('highlight');
        }

        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;
            handleFileImport({ target: { files } });
        }

        // Handle file import
        function handleFileImport(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            if (!file.name.endsWith('.json')) {
                showNotification('Hanya file JSON yang didukung!', 'error');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const importedData = JSON.parse(e.target.result);
                    
                    if (!confirm(`Import ${Object.keys(importedData).length} items? Data saat ini akan diganti.`)) {
                        return;
                    }
                    
                    // Clear current localStorage
                    localStorage.clear();
                    
                    // Import new data
                    for (const [key, value] of Object.entries(importedData)) {
                        localStorage.setItem(key, JSON.stringify(value));
                    }
                    
                    loadData();
                    updateStats();
                    showNotification('Data berhasil diimport!', 'success');
                    
                    // Log backup history
                    logBackupHistory('import', file.name);
                    
                } catch (error) {
                    showNotification('Format file tidak valid!', 'error');
                    console.error('Import error:', error);
                }
            };
            reader.readAsText(file);
        }

        // Edit data
        function editData(key) {
            currentEditingKey = key;
            const value = localStorage.getItem(key);
            
            document.getElementById('editKey').value = key;
            document.getElementById('editValue').value = value;
            
            document.getElementById('editModal').classList.add('active');
        }

        // Save edited data
        function saveEdit() {
            if (!currentEditingKey) return;
            
            const newValue = document.getElementById('editValue').value;
            
            try {
                // Try to parse as JSON for formatting
                JSON.parse(newValue);
                localStorage.setItem(currentEditingKey, newValue);
                showNotification('Data berhasil disimpan!', 'success');
            } catch (error) {
                // If not valid JSON, save as string
                localStorage.setItem(currentEditingKey, newValue);
                showNotification('Data berhasil disimpan (sebagai string)!', 'success');
            }
            
            closeModal();
            loadData();
            updateStats();
        }

        // Close modal
        function closeModal() {
            document.getElementById('editModal').classList.remove('active');
            currentEditingKey = null;
        }

        // Delete data
        function deleteData(key) {
            if (!confirm(`Hapus data "${key}"?`)) return;
            
            localStorage.removeItem(key);
            loadData();
            updateStats();
            showNotification(`Data "${key}" berhasil dihapus!`, 'success');
        }

        // Copy data to clipboard
        function copyData(key) {
            const value = localStorage.getItem(key);
            navigator.clipboard.writeText(value)
                .then(() => showNotification(`Data "${key}" disalin ke clipboard!`, 'success'))
                .catch(err => showNotification('Gagal menyalin data!', 'error'));
        }

        // Copy all data to clipboard
        function copyAllData() {
            const allData = {};
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                const value = localStorage.getItem(key);
                allData[key] = value;
            }
            
            navigator.clipboard.writeText(JSON.stringify(allData, null, 2))
                .then(() => showNotification('Semua data disalin ke clipboard!', 'success'))
                .catch(err => showNotification('Gagal menyalin data!', 'error'));
        }

        // Backup data
        function backupData(type) {
            const allData = {};
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                let value = localStorage.getItem(key);
                
                // Try to parse JSON for better formatting
                try {
                    value = JSON.parse(value);
                } catch (e) {
                    // Keep as string if not JSON
                }
                
                allData[key] = value;
            }
            
            const backupData = {
                data: allData,
                metadata: {
                    timestamp: new Date().toISOString(),
                    totalItems: Object.keys(allData).length,
                    app: 'X DKV 3 LocalStorage Manager'
                }
            };
            
            let dataStr, filename, mimeType;
            
            if (type === 'json') {
                dataStr = JSON.stringify(backupData, null, 2);
                filename = `backup_xdkv3_${new Date().toISOString().split('T')[0]}.json`;
                mimeType = 'application/json';
            } else {
                // For compressed, we'll just use JSON for now
                dataStr = JSON.stringify(backupData);
                filename = `backup_xdkv3_${new Date().toISOString().split('T')[0]}.json`;
                mimeType = 'application/json';
            }
            
            const dataUri = `data:${mimeType};charset=utf-8,${encodeURIComponent(dataStr)}`;
            
            const link = document.createElement('a');
            link.setAttribute('href', dataUri);
            link.setAttribute('download', filename);
            link.click();
            
            showNotification('Backup berhasil didownload!', 'success');
            
            // Log backup history
            logBackupHistory('backup', filename);
        }

        // Copy to clipboard
        function copyToClipboard() {
            const allData = {};
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                const value = localStorage.getItem(key);
                allData[key] = value;
            }
            
            navigator.clipboard.writeText(JSON.stringify(allData, null, 2))
                .then(() => showNotification('Data berhasil disalin ke clipboard!', 'success'))
                .catch(err => showNotification('Gagal menyalin data!', 'error'));
        }

        // Clear selected data
        function clearSelectedData() {
            const checkboxes = document.querySelectorAll('#clearList input[type="checkbox"]:checked');
            if (checkboxes.length === 0) {
                showNotification('Pilih data yang akan dihapus!', 'warning');
                return;
            }
            
            if (!confirm(`Hapus ${checkboxes.length} data terpilih?`)) return;
            
            checkboxes.forEach(cb => {
                localStorage.removeItem(cb.value);
            });
            
            loadData();
            updateStats();
            showNotification(`${checkboxes.length} data berhasil dihapus!`, 'success');
        }

        // Clear all data
        function clearAllData() {
            if (!confirm('HAPUS SEMUA DATA? Tindakan ini tidak dapat dibatalkan!')) return;
            
            localStorage.clear();
            loadData();
            updateStats();
            showNotification('Semua data berhasil dihapus!', 'success');
        }

        // Log backup history
        function logBackupHistory(type, filename) {
            const history = JSON.parse(localStorage.getItem('ls_backup_history') || '[]');
            
            history.push({
                type: type,
                filename: filename,
                timestamp: new Date().toISOString(),
                itemCount: localStorage.length
            });
            
            // Keep only last 10 entries
            if (history.length > 10) {
                history.shift();
            }
            
            localStorage.setItem('ls_backup_history', JSON.stringify(history));
            updateBackupHistory();
        }

        // Update backup history display
        function updateBackupHistory() {
            const history = JSON.parse(localStorage.getItem('ls_backup_history') || '[]');
            const container = document.getElementById('backupHistory');
            
            if (history.length === 0) {
                container.innerHTML = '<p>Tidak ada riwayat backup</p>';
                return;
            }
            
            let html = '<div style="display: grid; gap: 10px;">';
            history.reverse().forEach(item => {
                html += `
                    <div style="background: rgba(255,255,255,0.03); padding: 10px; border-radius: 5px; display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <div><strong>${item.filename}</strong></div>
                            <div style="font-size: 12px;">
                                ${new Date(item.timestamp).toLocaleString()} â€¢ ${item.type} â€¢ ${item.itemCount} items
                            </div>
                        </div>
                        <i class="fas fa-${item.type === 'backup' ? 'download' : 'upload'}" style="color: #4cc9f0;"></i>
                    </div>
                `;
            });
            html += '</div>';
            
            container.innerHTML = html;
        }

        // Show notification
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notificationText');
            
            notificationText.textContent = message;
            notification.className = 'notification';
            
            if (type === 'error') {
                notification.classList.add('error');
                notification.querySelector('i').className = 'fas fa-exclamation-circle';
            } else if (type === 'warning') {
                notification.classList.add('warning');
                notification.querySelector('i').className = 'fas fa-exclamation-triangle';
            } else {
                notification.querySelector('i').className = 'fas fa-check-circle';
            }
            
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Populate clear list
        function populateClearList() {
            const clearList = document.getElementById('clearList');
            clearList.innerHTML = '';
            
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                const value = localStorage.getItem(key);
                
                const div = document.createElement('div');
                div.style.cssText = 'display: flex; align-items: center; gap: 10px; padding: 10px; border-bottom: 1px solid rgba(255,255,255,0.1);';
                div.innerHTML = `
                    <input type="checkbox" value="${key}" id="clear_${key}">
                    <label for="clear_${key}" style="flex: 1;">
                        <strong>${key}</strong>
                        <div style="font-size: 12px; color: #8a8a8a;">
                            ${getKeyType(key)} â€¢ ${formatBytes(value.length)}
                        </div>
                    </label>
                `;
                
                clearList.appendChild(div);
            }
            
            // Select all checkbox
            document.getElementById('selectAll').addEventListener('change', function() {
                const checkboxes = document.querySelectorAll('#clearList input[type="checkbox"]');
                checkboxes.forEach(cb => {
                    cb.checked = this.checked;
                });
            });
        }

        // Check localStorage support
        function checkLocalStorageSupport() {
            try {
                localStorage.setItem('test', 'test');
                localStorage.removeItem('test');
                return true;
            } catch (e) {
                return false;
            }
        }

        // Export functions to global scope for debugging
        window.lsManager = {
            reload: loadData,
            stats: updateStats,
            backup: backupData,
            clearAll: clearAllData,
            checkCapacity: checkStorageCapacity,
            getData: () => localStorageData
        };

        // Initialize backup history
        updateBackupHistory();
        
        // Populate clear list when clear section is activated
        document.querySelector('[data-section="clear"]').addEventListener('click', populateClearList);
    </script>
</body>
</html>
